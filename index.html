<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lixdyrandomstuff ‚ú®</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚≠ê</text></svg>">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tourney:wght@400;700;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Lightbox CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css">
    
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    
    <!-- Browser Image Compression -->
    <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== TU PALETA ===== */
        :root {
            --color-jacarta: #3F2A52;
            --color-wisteria: #75619D;
            --color-lavender: #BEAEDB;
            --color-mist: #E6EFF7;
            --color-coffee: #3A2D34;
            
            --bg-start: var(--color-lavender);
            --bg-end: var(--color-mist);
            --bg-container: rgba(255, 255, 255, 0.97);
            --text-primary: var(--color-coffee);
            --text-secondary: #6D5A72;
            --accent-purple: var(--color-jacarta);
            --accent-dark-purple: var(--color-wisteria);
            --border-color: var(--color-lavender);
            --shadow: rgba(63, 42, 82, 0.15);
            
            --font-title: 'Tourney', cursive;
            --font-marquee: 'Playfair Display', serif;
            --font-body: 'Georgia', serif;
        }
        
        .dark-mode {
            --bg-start: var(--color-coffee);
            --bg-end: var(--color-jacarta);
            --bg-container: rgba(58, 45, 52, 0.95);
            --text-primary: var(--color-mist);
            --text-secondary: #C9ADA7;
            --accent-purple: var(--color-lavender);
            --border-color: var(--color-wisteria);
            --shadow: rgba(190, 174, 219, 0.25);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }
        
        body {
            background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
            color: var(--text-primary);
            font-family: var(--font-body);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* ===== CORAZONCITOS ===== */
        .floating-heart {
            position: fixed;
            font-size: 24px;
            z-index: -1;
            opacity: 0.4;
            animation: floatHeart 20s infinite linear;
            pointer-events: none;
        }
        
        @keyframes floatHeart {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        /* ===== DISCO ===== */
        .vinyl-player {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .vinyl-disc {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--color-jacarta), var(--color-wisteria), var(--color-coffee));
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(190, 174, 219, 0.5);
            animation: rotateVinyl 20s linear infinite;
            animation-play-state: paused;
            cursor: pointer;
        }
        
        .vinyl-disc.playing { animation-play-state: running; }
        
        @keyframes rotateVinyl {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ===== BANNER CON BOT√ìN DE EDITAR ===== */
        #siteBanner {
            width: 100%;
            max-width: 900px;
            height: 180px;
            margin: 0 auto 20px;
            border-radius: 15px;
            overflow: hidden;
            border: 4px solid var(--accent-purple);
            box-shadow: 0 5px 20px var(--shadow);
            position: relative;
        }
        
        #bannerImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        #siteBanner:hover .banner-overlay {
            opacity: 1;
        }
        
        /* ===== CONTROLES ===== */
        .top-controls {
            max-width: 900px;
            margin: 0 auto 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        /* ===== PERFIL CON BOT√ìN DE EDITAR FOTO ===== */
        .profile-section {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--accent-purple);
            flex-wrap: wrap;
            align-items: center;
            position: relative;
        }
        
        .avatar-container {
            position: relative;
            width: 120px;
            height: 120px;
        }
        
        #avatarImage {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid var(--accent-purple);
            object-fit: cover;
            background: linear-gradient(45deg, var(--color-wisteria), var(--color-lavender));
        }
        
        .avatar-upload-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: var(--accent-purple);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            z-index: 2;
        }
        
        .avatar-container:hover .avatar-upload-btn {
            display: flex;
        }
        
        /* ===== POSTS ===== */
        .post-item {
            background: var(--post-bg, rgba(255, 255, 255, 0.25));
            padding: 20px;
            margin: 25px 0;
            border-radius: 12px;
            border: 3px solid var(--post-color, var(--accent-purple));
            border-left: 8px solid var(--post-color, var(--accent-purple));
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .post-item:hover {
            transform: translateX(5px);
            box-shadow: 5px 5px 20px var(--shadow);
        }
        
        /* ===== COMENTARIOS CON RESPUESTAS FUNCIONALES ===== */
        .comments-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px dashed var(--border-color);
            display: none;
        }
        
        .comments-section.active {
            display: block;
        }
        
        .comment.reply {
            margin-left: 40px;
            background: rgba(190, 174, 219, 0.08);
            border-left: 3px solid var(--color-lavender);
            padding: 10px 12px;
            border-radius: 8px;
        }
        
        .reply-form {
            margin-top: 10px;
            padding: 10px;
            background: rgba(63, 42, 82, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: none;
        }
        
        .reply-form.active {
            display: block;
        }
        
        /* ===== MODALES PARA EDITAR ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: var(--bg-container);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            border: 5px solid var(--accent-purple);
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 28px;
            color: var(--color-lavender);
            cursor: pointer;
            background: none;
            border: none;
        }
        
        /* ===== BOTONES ===== */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Verdana', sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--color-jacarta), var(--color-wisteria));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px var(--shadow);
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 13px;
            border-radius: 15px;
        }
        
        /* ===== NOTIFICACIONES ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            background: var(--color-wisteria);
            color: white;
            z-index: 9999;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
            max-width: 300px;
            word-wrap: break-word;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .site-title { font-size: 2.2em; }
            .profile-section { flex-direction: column; text-align: center; }
            #siteBanner { height: 150px; }
            .vinyl-player { transform: scale(0.8); bottom: 20px; right: 20px; }
            .comment.reply { margin-left: 20px; }
        }
    </style>
</head>
<body>
    <!-- Corazoncitos -->
    <div id="heartsContainer"></div>

    <!-- Disco -->
    <div class="vinyl-player">
        <div class="vinyl-disc" onclick="toggleVinyl()">
            <div style="position: absolute; top: 30%; left: 30%; right: 30%; bottom: 30%; 
                       background: linear-gradient(45deg, var(--color-lavender), var(--color-mist));
                       border-radius: 50%; display: flex; align-items: center; justify-content: center;
                       color: var(--color-jacarta); font-weight: bold; font-size: 24px;">
                LIX
            </div>
        </div>
        <div style="background: var(--bg-container); padding: 10px 15px; border-radius: 25px;
                   display: flex; gap: 15px; align-items: center; border: 2px solid var(--border-color);">
            <button onclick="toggleVinyl()" style="background: none; border: none; color: var(--accent-purple);
                       font-size: 1.5em; cursor: pointer; width: 40px; height: 40px; border-radius: 50%;
                       display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-play"></i>
            </button>
            <button onclick="createSparkles()" style="background: none; border: none; color: var(--accent-purple);
                       font-size: 1.5em; cursor: pointer; width: 40px; height: 40px; border-radius: 50%;
                       display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-sparkles"></i>
            </button>
        </div>
    </div>

    <!-- Modal para cambiar banner -->
    <div id="bannerModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('bannerModal')">√ó</button>
            <h2 style="color: var(--accent-purple); font-family: var(--font-title); text-align: center;">
                üñºÔ∏è Cambiar Banner
            </h2>
            <p style="margin: 15px 0; color: var(--text-secondary); text-align: center;">
                Sube una imagen para tu banner (recomendado: 900x180px)
            </p>
            <input type="file" id="bannerUpload" accept="image/*" style="display: none;">
            <button onclick="document.getElementById('bannerUpload').click()" class="btn btn-primary" style="width: 100%; margin: 15px 0;">
                üìÅ Elegir Imagen
            </button>
            <div id="bannerPreview" style="margin: 20px 0; text-align: center;"></div>
            <button onclick="saveBanner()" class="btn btn-primary" style="width: 100%;">
                üíæ Guardar Banner
            </button>
        </div>
    </div>

    <!-- Modal para cambiar avatar -->
    <div id="avatarModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('avatarModal')">√ó</button>
            <h2 style="color: var(--accent-purple); font-family: var(--font-title); text-align: center;">
                üì∏ Cambiar Foto de Perfil
            </h2>
            <p style="margin: 15px 0; color: var(--text-secondary); text-align: center;">
                Sube una foto cuadrada (recomendado: 300x300px)
            </p>
            <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
            <button onclick="document.getElementById('avatarUpload').click()" class="btn btn-primary" style="width: 100%; margin: 15px 0;">
                üìÅ Elegir Foto
            </button>
            <div id="avatarPreview" style="margin: 20px 0; text-align: center;"></div>
            <button onclick="saveAvatar()" class="btn btn-primary" style="width: 100%;">
                üíæ Guardar Foto
            </button>
        </div>
    </div>

    <!-- Modal de login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('loginModal')">√ó</button>
            <h2 style="color: var(--accent-purple); font-family: var(--font-title); text-align: center;">
                üîê Acceso Owner
            </h2>
            <div style="margin: 20px 0;">
                <input type="email" id="ownerEmail" placeholder="Tu email" style="width: 100%; padding: 12px; 
                       border: 2px solid var(--border-color); border-radius: 8px; background: var(--bg-container);
                       color: var(--text-primary); margin-bottom: 15px;">
                <input type="password" id="ownerPassword" placeholder="Contrase√±a" style="width: 100%; padding: 12px;
                       border: 2px solid var(--border-color); border-radius: 8px; background: var(--bg-container);
                       color: var(--text-primary);">
            </div>
            <button onclick="loginOwner()" class="btn btn-primary" style="width: 100%;">
                ‚ú® Iniciar Sesi√≥n
            </button>
        </div>
    </div>

    <!-- Banner con bot√≥n para editar -->
    <div id="siteBanner">
        <img id="bannerImage" class="banner-image" alt="Banner de lixdy" src="https://via.placeholder.com/900x180/3F2A52/FFFFFF?text=lixdyrandomstuff">
        <div class="banner-overlay">
            <button onclick="openBannerModal()" class="btn btn-primary" id="editBannerBtn" style="display: none;">
                <i class="fas fa-edit"></i> Cambiar Banner
            </button>
        </div>
    </div>

    <!-- Controles -->
    <div class="top-controls">
        <div class="visitor-counter" style="background: var(--accent-purple); color: white; padding: 8px 15px;
                   border-radius: 20px; font-family: 'Courier New', monospace; font-weight: bold;">
            üëÅÔ∏è Visitante #<span id="counter">0000</span>
        </div>
        
        <div class="theme-toggle" onclick="toggleTheme()" style="display: flex; align-items: center; gap: 8px;
                   background: var(--bg-container); padding: 8px 15px; border-radius: 20px; border: 2px solid var(--border-color);
                   cursor: pointer;">
            <div class="toggle-switch" style="width: 40px; height: 20px; background: var(--accent-purple); border-radius: 10px;
                       position: relative;">
                <div style="position: absolute; width: 16px; height: 16px; background: white; border-radius: 50%;
                           top: 2px; left: 2px; transition: transform 0.3s;" id="toggleCircle"></div>
            </div>
            <span id="themeText">Modo Oscuro</span>
        </div>
        
        <button onclick="showLoginModal()" class="btn" style="background: var(--text-secondary); color: white;" id="loginBtn">
            üîì Iniciar Sesi√≥n
        </button>
    </div>

    <!-- Marquee -->
    <div style="max-width: 900px; margin: 0 auto 25px; overflow: hidden; border-radius: 8px;">
        <div style="background: linear-gradient(90deg, var(--color-jacarta), var(--color-wisteria), var(--color-jacarta));
                   color: white; padding: 12px; font-family: var(--font-marquee); font-size: 16px; border-radius: 8px;">
            <div style="display: inline-block; white-space: nowrap; animation: marqueeScroll 30s linear infinite;
                       padding-left: 100%;">
                („Å• ·¥ó _·¥ó)„Å•‚ô° ¬°BIENVENIDO A EL LUGAR DE MIS PENSAMIENTOS! - ( Àò ¬≥Àò)‚ô• sientete libre de comentar y dar like
            </div>
        </div>
    </div>

    <!-- Contenedor principal -->
    <div style="background: var(--bg-container); border: 6px double var(--accent-purple); padding: 25px;
               margin: 0 auto; max-width: 900px; border-radius: 15px; box-shadow: 0 0 30px var(--shadow);">
        
        <h1 class="site-title" style="font-family: var(--font-title); font-size: 3em; text-align: center;
            margin: 20px 0; color: var(--accent-purple); text-shadow: 2px 2px 4px var(--shadow);">
            lixdyrandomstuff
        </h1>
        
        <!-- Panel admin -->
        <div id="adminPanel" style="background: linear-gradient(135deg, var(--color-jacarta), var(--color-wisteria));
                   color: white; padding: 15px; border-radius: 10px; margin-bottom: 25px; display: none;
                   align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
            <div>
                üéÆ <strong>MODO OWNER ACTIVADO</strong> - ¬°Hola lixdy!
            </div>
            <button onclick="logout()" class="btn" style="background: var(--color-wisteria); color: white;">
                üîì Cerrar Sesi√≥n
            </button>
        </div>
        
        <!-- Perfil con bot√≥n para cambiar foto -->
        <div class="profile-section">
            <div class="avatar-container">
                <img id="avatarImage" class="avatar" alt="Avatar de lixdy" src="https://via.placeholder.com/300/75619D/FFFFFF?text=LIXDY">
                <button class="avatar-upload-btn" onclick="openAvatarModal()" title="Cambiar foto">
                    <i class="fas fa-camera"></i>
                </button>
            </div>
            
            <div class="profile-info" style="flex: 1; min-width: 200px;">
                <div class="profile-name" style="font-family: var(--font-title); font-size: 2em; color: var(--accent-purple);">
                    <span id="profileName">lixdy</span>
                </div>
                
                <div class="profile-bio" id="profileBio" style="color: var(--text-secondary); margin-top: 10px;
                       line-height: 1.5; padding: 10px; background: rgba(117, 97, 157, 0.08); border-radius: 8px;">
                    random stuff pq soy un poco weirdo
                </div>
                
                <div class="profile-stats" style="display: flex; gap: 20px; margin-top: 15px; flex-wrap: wrap;">
                    <div class="stat" style="text-align: center; padding: 8px 15px; background: rgba(63, 42, 82, 0.1);
                            border-radius: 10px; border: 1px solid var(--border-color);">
                        <div class="stat-number" style="font-family: var(--font-title); font-size: 1.5em; 
                                color: var(--color-wisteria); font-weight: bold;" id="statPosts">0</div>
                        <div class="stat-label">Posts</div>
                    </div>
                    <div class="stat" style="text-align: center; padding: 8px 15px; background: rgba(63, 42, 82, 0.1);
                            border-radius: 10px; border: 1px solid var(--border-color);">
                        <div class="stat-number" style="font-family: var(--font-title); font-size: 1.5em; 
                                color: var(--color-wisteria); font-weight: bold;" id="statComments">0</div>
                        <div class="stat-label">Comentarios</div>
                    </div>
                    <div class="stat" style="text-align: center; padding: 8px 15px; background: rgba(63, 42, 82, 0.1);
                            border-radius: 10px; border: 1px solid var(--border-color);">
                        <div class="stat-number" style="font-family: var(--font-title); font-size: 1.5em; 
                                color: var(--color-wisteria); font-weight: bold;" id="statLikes">0</div>
                        <div class="stat-label">Estrellitas</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Posts -->
        <div style="margin-top: 30px;">
            <h2 style="color: var(--accent-purple); border-bottom: 3px solid var(--color-wisteria);
                   padding-bottom: 10px; margin-bottom: 20px; font-family: var(--font-title);">
                üìù Mis Publicaciones:
            </h2>
            
            <div id="postsContainer">
                <!-- Posts cargar√°n aqu√≠ -->
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <p style="font-size: 1.2em;">üìù Cargando publicaciones...</p>
                </div>
            </div>
            
            <!-- Formulario para nuevo post -->
            <div id="newPostForm" style="display: none; background: rgba(117, 97, 157, 0.08); padding: 25px;
                   border-radius: 12px; border: 2px dashed var(--border-color); margin: 30px 0;">
                <h3 style="color: var(--accent-purple); margin-bottom: 20px;">‚ú® Nueva Publicaci√≥n:</h3>
                <form id="postForm">
                    <input type="text" id="postTitle" placeholder="T√≠tulo (opcional)" style="width: 100%; 
                           padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;
                           background: var(--bg-container); color: var(--text-primary); margin-bottom: 15px;">
                    
                    <textarea id="postContent" placeholder="¬øQu√© quieres compartir hoy?" style="width: 100%; 
                              padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;
                              background: var(--bg-container); color: var(--text-primary); min-height: 120px;
                              margin-bottom: 20px; resize: vertical;"></textarea>
                    
                    <div style="display: flex; gap: 15px; margin-top: 25px;">
                        <button type="submit" class="btn btn-primary">
                            ‚ú® Publicar
                        </button>
                        <button type="button" onclick="cancelPost()" class="btn" style="background: var(--text-secondary); color: white;">
                            Cancelar
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Bot√≥n para mostrar formulario -->
            <button id="showPostFormBtn" onclick="showPostForm()" class="btn btn-primary" 
                    style="display: none; margin: 30px auto; width: 100%; max-width: 300px;">
                üìù Crear Nueva Publicaci√≥n
            </button>
        </div>
        
        <!-- Comentarios generales -->
        <div style="margin-top: 40px; padding-top: 25px; border-top: 3px solid var(--accent-purple);">
            <h2 style="color: var(--accent-purple); margin-bottom: 20px; font-family: var(--font-title);">
                üí¨ Comentarios:
            </h2>
            
            <div style="background: rgba(63, 42, 82, 0.08); padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                <input type="text" id="commenterName" placeholder="Tu nombre o apodo" style="width: 100%; 
                       padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;
                       background: var(--bg-container); color: var(--text-primary); margin-bottom: 15px;">
                
                <textarea id="commentText" placeholder="Escribe tu comentario aqu√≠..." style="width: 100%; 
                          padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;
                          background: var(--bg-container); color: var(--text-primary); min-height: 80px;
                          margin-bottom: 15px; resize: vertical;"></textarea>
                
                <button onclick="addComment()" class="btn btn-primary">
                    üí¨ Enviar Comentario
                </button>
            </div>
            
            <div id="commentsContainer" style="max-height: 500px; overflow-y: auto; padding-right: 10px;">
                <!-- Comentarios cargar√°n aqu√≠ -->
            </div>
        </div>
        
        <!-- Footer -->
        <div style="text-align: center; margin-top: 50px; padding-top: 25px; color: var(--text-secondary);
               font-size: 14px; border-top: 2px dashed var(--border-color);">
            <p>
                <span style="color: var(--accent-purple);">‚≠ê</span> 
                lixdyrandomstuff ¬© 2026 ‚Ä¢ Mi proyecto personal ‚Ä¢ Hecho con üíú 
                <span style="color: var(--accent-purple);">‚≠ê</span>
            </p>
        </div>
    </div>

    <!-- Lightbox JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox-plus-jquery.min.js"></script>
    
    <script>
        // ===== CONFIGURACI√ìN =====
        const SUPABASE_URL = 'https://pfwzdislewisgcuoyiny.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_tyi-ak1lHgP3heMQuFcp4Q_LradvV9z';
        const OWNER_EMAIL = 'alexxa.svelasquez26@gmail.com';
        const OWNER_PASSWORD = '7010458714As.';
        
        // ===== VARIABLES =====
        let supabase = null;
        let isOwnerLoggedIn = false;
        let currentTheme = localStorage.getItem('theme') || 'light';
        let vinylPlaying = false;
        let selectedBannerFile = null;
        let selectedAvatarFile = null;
        let replyingToCommentId = null;
        
        // ===== INICIALIZACI√ìN =====
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // 1. Inicializar Supabase
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log('‚úÖ Supabase listo');
                
                // 2. Aplicar tema
                applyTheme(currentTheme);
                
                // 3. Verificar autenticaci√≥n
                await checkAuth();
                
                // 4. Cargar datos
                await loadPosts();
                await loadComments();
                
                // 5. Configurar eventos
                setupEventListeners();
                
                // 6. Actualizar contador
                updateVisitorCounter();
                updateStats();
                
                // 7. Corazoncitos
                createFloatingHearts();
                
                console.log('üéâ ¬°Todo listo!');
                showNotification('¬°Bienvenid@! ‚ú®', 'success');
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error cargando la p√°gina', 'error');
            }
        });
        
        // ===== TEMA =====
        function applyTheme(theme) {
            const body = document.body;
            const toggleCircle = document.getElementById('toggleCircle');
            const themeText = document.getElementById('themeText');
            
            if (theme === 'dark') {
                body.classList.add('dark-mode');
                toggleCircle.style.transform = 'translateX(20px)';
                themeText.textContent = 'Modo Claro';
            } else {
                body.classList.remove('dark-mode');
                toggleCircle.style.transform = 'translateX(2px)';
                themeText.textContent = 'Modo Oscuro';
            }
            localStorage.setItem('theme', theme);
        }
        
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme(currentTheme);
            createFloatingHearts();
            showNotification(`Modo ${currentTheme === 'dark' ? 'oscuro' : 'claro'} activado`, 'info');
        }
        
        // ===== DISCO =====
        function toggleVinyl() {
            const vinylDisc = document.querySelector('.vinyl-disc');
            const playBtn = document.querySelector('.vinyl-player button i');
            
            vinylPlaying = !vinylPlaying;
            
            if (vinylPlaying) {
                vinylDisc.classList.add('playing');
                playBtn.className = 'fas fa-pause';
                showNotification('üéµ Disco girando...', 'info');
            } else {
                vinylDisc.classList.remove('playing');
                playBtn.className = 'fas fa-play';
            }
        }
        
        function createSparkles() {
            const vinylPlayer = document.querySelector('.vinyl-player');
            const colors = ['#FFD700', '#FF6B8B', '#6B8BFF'];
            
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.style.cssText = `
                    position: absolute; width: 8px; height: 8px; border-radius: 50%;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    animation: sparkle 1s ease-out forwards;
                    top: 50px; left: 50px;
                `;
                
                vinylPlayer.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 1000);
            }
        }
        
        // ===== EDITAR FOTO Y BANNER =====
        function openBannerModal() {
            if (!isOwnerLoggedIn) {
                showNotification('Inicia sesi√≥n para cambiar el banner', 'error');
                return;
            }
            
            document.getElementById('bannerModal').style.display = 'flex';
            document.getElementById('bannerUpload').onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('La imagen es muy grande (>5MB)', 'error');
                    return;
                }
                
                selectedBannerFile = file;
                const reader = new FileReader();
                reader.onload = function(event) {
                    document.getElementById('bannerPreview').innerHTML = `
                        <img src="${event.target.result}" style="max-width: 100%; max-height: 200px; border-radius: 10px;">
                    `;
                };
                reader.readAsDataURL(file);
            };
        }
        
        async function saveBanner() {
            if (!selectedBannerFile) {
                showNotification('Elige una imagen primero', 'error');
                return;
            }
            
            try {
                showNotification('Subiendo banner...', 'info');
                
                // Aqu√≠ normalmente subir√≠as a Supabase Storage
                // Por ahora lo haremos con Data URL (local)
                const reader = new FileReader();
                reader.onload = function(event) {
                    const bannerImage = document.getElementById('bannerImage');
                    bannerImage.src = event.target.result;
                    localStorage.setItem('customBanner', event.target.result);
                    
                    closeModal('bannerModal');
                    showNotification('¬°Banner actualizado! üñºÔ∏è', 'success');
                    selectedBannerFile = null;
                    document.getElementById('bannerPreview').innerHTML = '';
                };
                reader.readAsDataURL(selectedBannerFile);
                
            } catch (error) {
                showNotification('Error: ' + error.message, 'error');
            }
        }
        
        function openAvatarModal() {
            if (!isOwnerLoggedIn) {
                showNotification('Inicia sesi√≥n para cambiar tu foto', 'error');
                return;
            }
            
            document.getElementById('avatarModal').style.display = 'flex';
            document.getElementById('avatarUpload').onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (file.size > 2 * 1024 * 1024) {
                    showNotification('La imagen es muy grande (>2MB)', 'error');
                    return;
                }
                
                selectedAvatarFile = file;
                const reader = new FileReader();
                reader.onload = function(event) {
                    document.getElementById('avatarPreview').innerHTML = `
                        <img src="${event.target.result}" style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 4px solid var(--accent-purple);">
                    `;
                };
                reader.readAsDataURL(file);
            };
        }
        
        async function saveAvatar() {
            if (!selectedAvatarFile) {
                showNotification('Elige una foto primero', 'error');
                return;
            }
            
            try {
                showNotification('Actualizando foto...', 'info');
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    const avatarImage = document.getElementById('avatarImage');
                    avatarImage.src = event.target.result;
                    localStorage.setItem('customAvatar', event.target.result);
                    
                    closeModal('avatarModal');
                    showNotification('¬°Foto actualizada! üì∏', 'success');
                    selectedAvatarFile = null;
                    document.getElementById('avatarPreview').innerHTML = '';
                };
                reader.readAsDataURL(selectedAvatarFile);
                
            } catch (error) {
                showNotification('Error: ' + error.message, 'error');
            }
        }
        
        // Cargar im√°genes guardadas
        window.addEventListener('load', function() {
            const savedBanner = localStorage.getItem('customBanner');
            const savedAvatar = localStorage.getItem('customAvatar');
            
            if (savedBanner) {
                document.getElementById('bannerImage').src = savedBanner;
            }
            if (savedAvatar) {
                document.getElementById('avatarImage').src = savedAvatar;
            }
        });
        
        // ===== AUTENTICACI√ìN =====
        async function checkAuth() {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                isOwnerLoggedIn = !!(user && user.email === OWNER_EMAIL);
                updateUIForOwner();
            } catch (error) {
                isOwnerLoggedIn = false;
            }
        }
        
        function updateUIForOwner() {
            const adminPanel = document.getElementById('adminPanel');
            const showPostBtn = document.getElementById('showPostFormBtn');
            const editBannerBtn = document.getElementById('editBannerBtn');
            const loginBtn = document.getElementById('loginBtn');
            
            if (isOwnerLoggedIn) {
                adminPanel.style.display = 'flex';
                showPostBtn.style.display = 'block';
                editBannerBtn.style.display = 'inline-flex';
                loginBtn.style.display = 'none';
            } else {
                adminPanel.style.display = 'none';
                showPostBtn.style.display = 'none';
                editBannerBtn.style.display = 'none';
                loginBtn.style.display = 'inline-flex';
            }
        }
        
        async function loginOwner() {
            const email = document.getElementById('ownerEmail').value || OWNER_EMAIL;
            const password = document.getElementById('ownerPassword').value || OWNER_PASSWORD;
            
            try {
                const { error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) {
                    // Intentar crear cuenta
                    const { error: signUpError } = await supabase.auth.signUp({
                        email: email,
                        password: password
                    });
                    
                    if (signUpError) {
                        showNotification('Error: ' + signUpError.message, 'error');
                        return;
                    }
                    
                    showNotification('Cuenta creada. Ahora inicia sesi√≥n.', 'success');
                    return;
                }
                
                isOwnerLoggedIn = true;
                updateUIForOwner();
                closeModal('loginModal');
                showNotification('¬°Bienvenida lixdy! üíú', 'success');
                
            } catch (error) {
                showNotification('Error inesperado', 'error');
            }
        }
        
        async function logout() {
            try {
                await supabase.auth.signOut();
                isOwnerLoggedIn = false;
                updateUIForOwner();
                showNotification('Sesi√≥n cerrada', 'info');
            } catch (error) {
                showNotification('Error cerrando sesi√≥n', 'error');
            }
        }
        
        // ===== POSTS =====
        async function loadPosts() {
            try {
                const { data: posts, error } = await supabase
                    .from('posts')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const container = document.getElementById('postsContainer');
                container.innerHTML = '';
                
                if (!posts || posts.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px; color: var(--text-secondary);">
                            <p style="font-size: 1.3em;">üìù A√∫n no hay publicaciones</p>
                            <p>¬°S√© la primera en compartir algo!</p>
                        </div>
                    `;
                    return;
                }
                
                posts.forEach(post => {
                    const postElement = createPostElement(post);
                    container.appendChild(postElement);
                });
                
            } catch (error) {
                console.error('Error cargando posts:', error);
            }
        }
        
        function createPostElement(post) {
            const div = document.createElement('div');
            div.className = 'post-item';
            div.id = `post-${post.id}`;
            
            div.innerHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <h3 style="font-family: var(--font-title); color: var(--accent-purple);">${post.title || 'Publicaci√≥n'}</h3>
                    <div style="color: var(--text-secondary); font-size: 0.9em;">
                        ${new Date(post.created_at).toLocaleDateString('es-ES')}
                    </div>
                </div>
                
                <div style="white-space: pre-wrap; margin-bottom: 20px;">${post.content || ''}</div>
                
                <div style="display: flex; gap: 10px; margin-top: 15px; padding-top: 15px; border-top: 1px dashed var(--border-color);">
                    <button onclick="toggleLike(${post.id})" style="background: none; border: none; font-size: 1.8em; cursor: pointer;">
                        ‚òÜ
                    </button>
                    <span style="font-family: var(--font-title); font-size: 1.3em; color: var(--color-wisteria);">
                        ${post.likes || 0}
                    </span>
                    
                    <button onclick="toggleComments(${post.id})" style="background: none; border: none; color: var(--text-secondary); cursor: pointer;
                            padding: 5px 10px; border-radius: 15px; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-comment"></i>
                        <span>${post.comments_count || 0}</span>
                    </button>
                </div>
                
                <div class="comments-section" id="comments-${post.id}">
                    <div style="background: rgba(63, 42, 82, 0.08); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <input type="text" id="commenterName-${post.id}" placeholder="Tu nombre" value="${localStorage.getItem('commenterName') || ''}"
                               style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; margin-bottom: 10px;">
                        <textarea id="commentText-${post.id}" placeholder="Escribe un comentario..." rows="2"
                                  style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px;"></textarea>
                        <button onclick="addCommentToPost(${post.id})" class="btn btn-primary" style="margin-top: 10px; padding: 8px 15px;">
                            üí¨ Comentar
                        </button>
                    </div>
                    
                    <div id="commentsContainer-${post.id}">
                        <!-- Comentarios cargar√°n aqu√≠ -->
                    </div>
                </div>
            `;
            
            return div;
        }
        
        // ===== COMENTARIOS CON RESPUESTAS =====
        async function loadCommentsForPost(postId) {
            try {
                const { data: comments, error } = await supabase
                    .from('comments')
                    .select('*')
                    .eq('post_id', postId)
                    .order('created_at', { ascending: true });
                
                if (error) throw error;
                
                const container = document.getElementById(`commentsContainer-${postId}`);
                container.innerHTML = '';
                
                if (!comments || comments.length === 0) {
                    container.innerHTML = `<p style="text-align: center; color: var(--text-secondary);">üí¨ S√© el primero en comentar</p>`;
                    return;
                }
                
                const mainComments = comments.filter(c => !c.parent_id);
                const replies = comments.filter(c => c.parent_id);
                
                mainComments.forEach(comment => {
                    const commentElement = createCommentElement(comment);
                    container.appendChild(commentElement);
                    
                    // Agregar respuestas
                    const commentReplies = replies.filter(r => r.parent_id === comment.id);
                    commentReplies.forEach(reply => {
                        const replyElement = createCommentElement(reply, true);
                        container.appendChild(replyElement);
                    });
                });
                
            } catch (error) {
                console.error('Error cargando comentarios:', error);
            }
        }
        
        function createCommentElement(comment, isReply = false) {
            const div = document.createElement('div');
            div.className = `comment ${isReply ? 'reply' : ''}`;
            
            const date = new Date(comment.created_at);
            const formattedDate = date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) + 
                                 ' ¬∑ ' + date.toLocaleDateString('es-ES');
            
            div.innerHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span style="color: var(--accent-purple); font-weight: bold;">${comment.author_name || 'An√≥nimo'}</span>
                    <span style="color: var(--text-secondary); font-size: 0.8em;">${formattedDate}</span>
                </div>
                <div style="line-height: 1.4; margin-bottom: 8px;">${comment.content || ''}</div>
                ${!isReply ? `
                <div style="display: flex; gap: 10px; margin-top: 8px;">
                    <button onclick="showReplyForm('${comment.id}', '${comment.author_name}')" 
                            style="background: none; border: none; color: var(--text-secondary); cursor: pointer;
                                   padding: 2px 6px; border-radius: 10px; font-size: 0.9em;">
                        <i class="fas fa-reply"></i> Responder
                    </button>
                </div>
                
                <div class="reply-form" id="reply-form-${comment.id}">
                    <textarea id="reply-text-${comment.id}" placeholder="Escribe tu respuesta..." rows="2"
                              style="width: 100%; padding: 8px; border: 2px solid var(--border-color); 
                                     border-radius: 8px; margin-bottom: 8px;"></textarea>
                    <button onclick="submitReply('${comment.id}')" class="btn btn-primary btn-small">
                        üí¨ Enviar Respuesta
                    </button>
                    <button onclick="hideReplyForm('${comment.id}')" class="btn btn-small" 
                            style="background: var(--text-secondary); color: white; margin-left: 8px;">
                        Cancelar
                    </button>
                </div>
                ` : ''}
            `;
            
            return div;
        }
        
        function showReplyForm(commentId, authorName) {
            // Ocultar otros formularios de respuesta
            document.querySelectorAll('.reply-form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Mostrar este formulario
            const replyForm = document.getElementById(`reply-form-${commentId}`);
            if (replyForm) {
                replyForm.classList.add('active');
                replyForm.querySelector('textarea').placeholder = `Respondiendo a ${authorName}...`;
                replyForm.querySelector('textarea').focus();
                replyingToCommentId = commentId;
            }
        }
        
        function hideReplyForm(commentId) {
            const replyForm = document.getElementById(`reply-form-${commentId}`);
            if (replyForm) {
                replyForm.classList.remove('active');
                replyForm.querySelector('textarea').value = '';
                replyingToCommentId = null;
            }
        }
        
        async function submitReply(commentId) {
            const replyText = document.getElementById(`reply-text-${commentId}`).value.trim();
            const commenterName = document.getElementById(`commenterName-${commentId}`)?.value.trim() || 
                                 localStorage.getItem('commenterName') || 'An√≥nimo';
            
            if (!replyText) {
                showNotification('¬°Escribe una respuesta!', 'error');
                return;
            }
            
            try {
                // Obtener el post_id del comentario
                const { data: parentComment } = await supabase
                    .from('comments')
                    .select('post_id')
                    .eq('id', commentId)
                    .single();
                
                if (!parentComment) throw new Error('Comentario no encontrado');
                
                // Insertar respuesta
                const { error } = await supabase
                    .from('comments')
                    .insert([{
                        post_id: parentComment.post_id,
                        parent_id: commentId,
                        author_name: commenterName,
                        content: replyText,
                        created_at: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                // Actualizar contador de comentarios del post
                const { data: post } = await supabase
                    .from('posts')
                    .select('comments_count')
                    .eq('id', parentComment.post_id)
                    .single();
                
                if (post) {
                    await supabase
                        .from('posts')
                        .update({ comments_count: (post.comments_count || 0) + 1 })
                        .eq('id', parentComment.post_id);
                }
                
                // Limpiar y actualizar
                hideReplyForm(commentId);
                await loadCommentsForPost(parentComment.post_id);
                updateStats();
                
                showNotification('¬°Respuesta enviada! üí¨', 'success');
                
            } catch (error) {
                console.error('Error enviando respuesta:', error);
                showNotification('Error al responder', 'error');
            }
        }
        
        function toggleComments(postId) {
            const commentsSection = document.getElementById(`comments-${postId}`);
            commentsSection.classList.toggle('active');
            
            if (commentsSection.classList.contains('active')) {
                loadCommentsForPost(postId);
            }
        }
        
        // ===== FUNCIONES RESTANTES =====
        function setupEventListeners() {
            document.getElementById('postForm')?.addEventListener('submit', handlePostSubmit);
            document.getElementById('loginBtn')?.addEventListener('click', showLoginModal);
        }
        
        async function handlePostSubmit(e) {
            e.preventDefault();
            
            if (!isOwnerLoggedIn) {
                showNotification('Inicia sesi√≥n para publicar', 'error');
                return;
            }
            
            const title = document.getElementById('postTitle').value.trim();
            const content = document.getElementById('postContent').value.trim();
            
            if (!content) {
                showNotification('¬°Escribe algo!', 'error');
                return;
            }
            
            try {
                const { error } = await supabase
                    .from('posts')
                    .insert([{
                        title: title || null,
                        content: content,
                        likes: 0,
                        comments_count: 0,
                        created_at: new Date().toISOString(),
                        owner_id: 'lixdy'
                    }]);
                
                if (error) throw error;
                
                cancelPost();
                await loadPosts();
                updateStats();
                showNotification('¬°Publicado! ‚ú®', 'success');
                
            } catch (error) {
                showNotification('Error: ' + error.message, 'error');
            }
        }
        
        async function addCommentToPost(postId) {
            const nameInput = document.getElementById(`commenterName-${postId}`);
            const textInput = document.getElementById(`commentText-${postId}`);
            
            const name = nameInput?.value.trim() || 'An√≥nimo';
            const text = textInput?.value.trim();
            
            if (!text) {
                showNotification('¬°Escribe un comentario!', 'error');
                return;
            }
            
            try {
                if (nameInput) localStorage.setItem('commenterName', name);
                
                const { error } = await supabase
                    .from('comments')
                    .insert([{
                        post_id: postId,
                        author_name: name,
                        content: text,
                        created_at: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                // Actualizar contador
                const { data: post } = await supabase
                    .from('posts')
                    .select('comments_count')
                    .eq('id', postId)
                    .single();
                
                if (post) {
                    await supabase
                        .from('posts')
                        .update({ comments_count: (post.comments_count || 0) + 1 })
                        .eq('id', postId);
                }
                
                if (textInput) textInput.value = '';
                await loadCommentsForPost(postId);
                updateStats();
                
                showNotification('¬°Comentario enviado! üí¨', 'success');
                
            } catch (error) {
                console.error('Error comentando:', error);
                showNotification('Error al comentar', 'error');
            }
        }
        
        async function addComment() {
            const nameInput = document.getElementById('commenterName');
            const textInput = document.getElementById('commentText');
            
            const name = nameInput?.value.trim() || 'An√≥nimo';
            const text = textInput?.value.trim();
            
            if (!text) {
                showNotification('¬°Escribe un comentario!', 'error');
                return;
            }
            
            try {
                if (nameInput) localStorage.setItem('commenterName', name);
                
                const { data: posts } = await supabase
                    .from('posts')
                    .select('id')
                    .order('created_at', { ascending: false })
                    .limit(1);
                
                if (!posts || posts.length === 0) {
                    showNotification('Crea un post primero', 'error');
                    return;
                }
                
                const postId = posts[0].id;
                
                const { error } = await supabase
                    .from('comments')
                    .insert([{
                        post_id: postId,
                        author_name: name,
                        content: text,
                        created_at: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                if (textInput) textInput.value = '';
                await loadComments();
                await loadPosts();
                updateStats();
                
                showNotification('¬°Comentario enviado! üí¨', 'success');
                
            } catch (error) {
                console.error('Error comentando:', error);
                showNotification('Error al comentar', 'error');
            }
        }
        
        async function loadComments() {
            try {
                const { data: comments, error } = await supabase
                    .from('comments')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(20);
                
                if (error) throw error;
                
                const container = document.getElementById('commentsContainer');
                container.innerHTML = '';
                
                if (!comments || comments.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 30px; color: var(--text-secondary);">
                            <p>üí¨ A√∫n no hay comentarios</p>
                        </div>
                    `;
                    return;
                }
                
                comments.forEach(comment => {
                    const div = document.createElement('div');
                    div.className = 'comment';
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--accent-purple); font-weight: bold;">${comment.author_name || 'An√≥nimo'}</span>
                            <span style="color: var(--text-secondary); font-size: 0.8em;">
                                ${new Date(comment.created_at).toLocaleDateString('es-ES')}
                            </span>
                        </div>
                        <div>${comment.content || ''}</div>
                    `;
                    container.appendChild(div);
                });
                
            } catch (error) {
                console.error('Error cargando comentarios:', error);
            }
        }
        
        async function toggleLike(postId) {
            const likeBtn = document.querySelector(`#post-${postId} button`);
            const likeCount = document.querySelector(`#post-${postId} span`);
            
            const currentLikes = parseInt(likeCount.textContent) || 0;
            const liked = likeBtn.textContent === '‚≠ê';
            
            if (liked) {
                likeBtn.textContent = '‚òÜ';
                likeCount.textContent = currentLikes - 1;
            } else {
                likeBtn.textContent = '‚≠ê';
                likeCount.textContent = currentLikes + 1;
                
                // Efecto de estrellitas
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        createStars(likeBtn);
                    }, i * 100);
                }
            }
            
            try {
                await supabase
                    .from('posts')
                    .update({ likes: liked ? currentLikes - 1 : currentLikes + 1 })
                    .eq('id', postId);
                    
                updateStats();
            } catch (error) {
                console.error('Error actualizando like:', error);
            }
        }
        
        function createStars(element) {
            const star = document.createElement('div');
            star.style.cssText = `
                position: fixed; width: 12px; height: 12px;
                background: #FFD700; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
                left: ${element.getBoundingClientRect().left + element.offsetWidth/2}px;
                top: ${element.getBoundingClientRect().top + element.offsetHeight/2}px;
                z-index: 9999; pointer-events: none; animation: starFloat 1s forwards;
            `;
            
            document.body.appendChild(star);
            setTimeout(() => star.remove(), 1000);
        }
        
        async function updateStats() {
            try {
                const { data: posts } = await supabase.from('posts').select('id, likes, comments_count');
                const { data: comments } = await supabase.from('comments').select('id');
                
                if (posts) {
                    document.getElementById('statPosts').textContent = posts.length;
                    document.getElementById('statLikes').textContent = posts.reduce((sum, post) => sum + (post.likes || 0), 0);
                    document.getElementById('statComments').textContent = comments ? comments.length : 0;
                }
            } catch (error) {
                console.error('Error stats:', error);
            }
        }
        
        function updateVisitorCounter() {
            let count = localStorage.getItem('visitCount') || 0;
            count = parseInt(count) + 1;
            localStorage.setItem('visitCount', count);
            document.getElementById('counter').textContent = count.toString().padStart(4, '0');
        }
        
        function createFloatingHearts() {
            const container = document.getElementById('heartsContainer');
            container.innerHTML = '';
            
            const hearts = ['üíú', '‚ù§Ô∏è', 'üíñ'];
            for (let i = 0; i < 12; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDelay = Math.random() * 15 + 's';
                heart.style.color = currentTheme === 'dark' ? '#C896FF' : '#75619D';
                container.appendChild(heart);
            }
        }
        
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function showPostForm() {
            document.getElementById('newPostForm').style.display = 'block';
            document.getElementById('showPostFormBtn').style.display = 'none';
        }
        
        function cancelPost() {
            document.getElementById('newPostForm').style.display = 'none';
            document.getElementById('showPostFormBtn').style.display = 'block';
            document.getElementById('postForm').reset();
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.background = type === 'error' ? '#8B5A6D' : 
                                          type === 'success' ? '#75619D' : '#3F2A52';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // CSS para animaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes marqueeScroll {
                0% { transform: translateX(0); }
                100% { transform: translateX(-100%); }
            }
            @keyframes starFloat {
                0% { transform: translate(0, 0) scale(0); opacity: 1; }
                100% { transform: translate(var(--tx, 20px), var(--ty, -20px)) scale(1); opacity: 0; }
            }
            @keyframes sparkle {
                0% { transform: scale(0) rotate(0deg); opacity: 0; }
                50% { opacity: 1; }
                100% { transform: scale(1) rotate(180deg) translate(20px, -20px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
